# AEGIS v3.0 Monitoring

실시간 모니터링 대시보드

## 📊 Watch Dashboard (Rich UI)

### Features

✅ **포트폴리오 현황**
- 총 평가액, 현금, 주식평가
- 총 손익 (금액 + 퍼센트)
- 🎯 목표 수익률 달성도 프로그레스 바

✅ **보유 종목 상세**
- 종목별 수량, 평단가, 현재가
- 손익률 색상 표시 (🟢 green / 🔴 red)
- 📊 각 종목별 수익률 막대 그래프

✅ **🎯 Recent Signals (최근 5개)**
- AI 추천 시그널 (BUY/SELL/HOLD)
- 점수, 신뢰도, 사유

✅ **⏰ Upcoming Schedule**
- 앞으로 실행될 스케줄 (KRX 데이터, Brain 분석, 장 시작/마감 등)
- 현재 시간 기준 하이라이트

✅ **🔄 Running Processes**
- 실행중인 AEGIS 관련 프로세스
- PID, CPU%, 메모리 사용량

✅ **💰 Recent Trades (최근 5건)**
- 최근 거래 내역
- 매수/매도 구분 (🟢/🔴)

✅ **🧠 Sonnet Commander Decisions (최근 3건)**
- Sonnet 4.5 Commander의 최종 결재 로그
- 종목, 액션, 사유, 신뢰도

✅ **⚙️ System Status**
- MIN_SCORE, 연속 손절/익절
- Circuit Breaker 상태
- 오늘 거래 건수

## 실행 방법

### 1. 일회성 실행

```bash
python monitoring/watch_dashboard_rich.py
```

### 2. Auto-refresh (3초마다 갱신)

```bash
./watch.sh
```

또는

```bash
watch -n 3 python monitoring/watch_dashboard_rich.py
```

## 의존성

```
rich==13.7.0
psutil==5.9.8
```

이미 `requirements.txt`에 포함되어 있습니다.

## 스크린샷

```
╭──────────────────────────────────────────────────────────────────────────────╮
│                       🤖 AEGIS v3.0 - WATCH DASHBOARD                        │
╰──────────────────────────────── 2025-12-10 03:02:34 ───────────────────────╯

         📊 PORTFOLIO SUMMARY
╭────────────┬─────────────┬─────────╮
│ 항목       │        금액 │    비중 │
├────────────┼─────────────┼─────────┤
│ 총 평가액  │ ₩15,000,000 │  100.0% │
│ 현금       │  ₩5,000,000 │   33.3% │
│ 주식평가   │ ₩10,000,000 │   66.7% │
│ 🟢 총 손익 │  +5,000,000 │ +50.00% │
╰────────────┴─────────────┴─────────╯

🎯 목표 수익률 달성도
현재: +50.00% / 목표: 10.0% ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100.0%

                                  📈 HOLDINGS
╭─────────┬─────┬───────┬───────┬────────┬─────────────────────────────────────╮
│ 종목    │ 수… │ 평단… │ 현재… │ 손익률 │ 수익률 그래프                       │
├─────────┼─────┼───────┼───────┼────────┼─────────────────────────────────────┤
│ 🟢      │ 100 │ 95,0… │ 108,… │ +14.1… │ ██████████████████████████████      │
│ 삼성전… │     │       │       │        │ +14.11%                             │
╰─────────┴─────┴───────┴───────┴────────┴─────────────────────────────────────╯
```

## 설정

### 목표 수익률 변경

`watch_dashboard_rich.py` 파일에서:

```python
def __init__(self):
    # ...
    self.target_profit_rate = 10.0  # 10% 목표 (원하는 값으로 변경)
```

## 기존 대시보드 vs Rich 대시보드

| 기능 | 기존 (watch_dashboard.py) | Rich (watch_dashboard_rich.py) |
|------|---------------------------|--------------------------------|
| 포트폴리오 현황 | ✅ 텍스트 | ✅ Table + 색상 |
| 목표 수익률 | ❌ | ✅ Progress Bar |
| 보유 종목 | ✅ 텍스트 | ✅ Table + 수익률 막대 그래프 |
| Recent Signals | ✅ | ✅ 색상 강조 |
| 스케줄 | ❌ | ✅ 시간별 하이라이트 |
| 실행중 프로세스 | ❌ | ✅ CPU/메모리 표시 |
| UI 라이브러리 | 없음 | Rich |

## 참고

- Rich 문서: https://rich.readthedocs.io/
- psutil 문서: https://psutil.readthedocs.io/
